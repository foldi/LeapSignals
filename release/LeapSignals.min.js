/*! LeapSignals v1.0.0 - 2013-10-02 01:10:15 
Vince Allen |Brooklyn, NY | vince@vinceallen.com | @vinceallenvince | License: MIT */
!function(a,b){function c(a,b){var c=a||0,d=b||0;this.x=c,this.y=d}function d(){if(!Leap)throw new Error("A new System requires Leap.");this.controller=null,this.viewportSize=null,this.iBoxWidth=null,this.iBoxHeight=null,this.iBoxDepth=null,this.interactionBox=null}function e(a){var b=a||{};f.call(this,b),this.name="Connector"}function f(){this.id=d.getId(),this.el=document.createElement("div"),this.el.className="item",this.el.id=this.id,document.body.appendChild(this.el)}function g(a){f.call(this,a),this.name="Palm"}function h(a){f.call(this,a),this.name="Finger",this.connector=a.connector}b.LeapSignals=a;var i={};i.extend=function(a,b){function c(){}c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a,a._superClass=b},i.getViewportSize=function(){var a={width:!1,height:!1};return"undefined"!=typeof window.innerWidth?(a.width=window.innerWidth,a.height=window.innerHeight):"undefined"!=typeof document.documentElement&&"undefined"!=typeof document.documentElement.clientWidth?(a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight):"undefined"!=typeof document.body&&(a.width=document.body.clientWidth,a.height=document.body.clientHeight),a},i.map=function(a,b,c,d,e){var f=(a-b)/(c-b);return f*(e-d)+d},i.radiansToDegrees=function(a){return"undefined"!=typeof a?a*(180/Math.PI):("undefined"!=typeof console&&console.log("Error: Utils.radiansToDegrees is missing radians param."),!1)},i.constrain=function(a,b,c){return a>c?c:b>a?b:a},i.getCSSText=function(a){var b="transform: translate3d(<x>px, <y>px, 0) rotate(<angle>deg) scale(<scale>, <scale>); -webkit-transform: translate3d(<x>px, <y>px, 0) rotate(<angle>deg) scale(<scale>, <scale>); -moz-transform: translate3d(<x>px, <y>px, 0) rotate(<angle>deg) scale(<scale>, <scale>); -o-transform: translate3d(<x>px, <y>px, 0) rotate(<angle>deg) scale(<scale>, <scale>); -ms-transform: translate3d(<x>px, <y>px, 0) rotate(<angle>deg) scale(<scale>, <scale>);";return b.replace(/<x>/g,a.x).replace(/<y>/g,a.y).replace(/<angle>/g,a.angle).replace(/<scale>/g,a.scale)+"width: "+a.width+"px; height: "+a.height+"px; visibility: "+a.visibility+"; background-color: rgb("+a.color0+", "+a.color1+", "+a.color2+"); border-radius: "+a.borderRadius+"%; border: "+a.borderWidth+"px "+a.borderStyle+" rgb(0, 0, 0); z-index: "+a.zIndex+";"},c.VectorSub=function(a,b){return new c(a.x-b.x,a.y-b.y)},c.VectorAdd=function(a,b){return new c(a.x+b.x,a.y+b.y)},c.VectorMult=function(a,b){return new c(a.x*b,a.y*b)},c.VectorDiv=function(a,b){return new c(a.x/b,a.y/b)},c.VectorDistance=function(a,b){return Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2))},c.VectorMidPoint=function(a,b){return c.VectorAdd(a,b).div(2)},c.VectorAngleBetween=function(a,b){var c=a.dot(b),d=Math.acos(c/(a.mag()*b.mag()));return d},c.prototype.name="Vector",c.prototype.clone=function(){function a(){}return a.prototype=this,new a},c.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this},c.prototype.sub=function(a){return this.x-=a.x,this.y-=a.y,this},c.prototype.mult=function(a){return this.x*=a,this.y*=a,this},c.prototype.div=function(a){return this.x=this.x/a,this.y=this.y/a,this},c.prototype.mag=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},c.prototype.limit=function(a,b){var c=a||null,d=b||null;return c&&this.mag()>c&&(this.normalize(),this.mult(c)),d&&this.mag()<d&&(this.normalize(),this.mult(d)),this},c.prototype.normalize=function(){var a=this.mag();return 0!==a?this.div(a):void 0},c.prototype.distance=function(a){return Math.sqrt(Math.pow(a.x-this.x,2)+Math.pow(a.y-this.y,2))},c.prototype.rotate=function(a){var b=Math.cos(a),c=Math.sin(a),d=this.x,e=this.y;return this.x=d*b-e*c,this.y=d*c+e*b,this},c.prototype.midpoint=function(a){return c.VectorAdd(this,a).div(2)},c.prototype.dot=function(a){return this.z&&a.z?this.x*a.x+this.y*a.y+this.z*a.z:this.x*a.x+this.y*a.y},d._records={list:[]},d.idCount=0,d.ready=!1,d.toggle=!1,d.gestureCallbacks={swipe:function(a){a.direction[0]>0?console.log("right"):console.log("left")}},d._pool=[],d.init=function(b,c,e,f){this.viewportSize=a.Utils.getViewportSize(),this.iBoxWidth=800,this.iBoxHeight=300,this.iBoxDepth=300,this.interactionBox=new Leap.InteractionBox({center:[0,this.iBoxHeight/2,0],size:[this.iBoxWidth,this.iBoxHeight,this.iBoxDepth]}),this.controller=new Leap.Controller({enableGestures:!0}),this.controller.on("connect",function(){console.log("LEAP: The client is connected to the websocket server.")}),this.controller.on("ready",function(){console.log("LEAP: The protocol has been selected.")}),this.controller.on("deviceConnected",function(){console.log("LEAP: A Leap device has been connected.")}),this.controller.on("deviceDisconnected",function(){console.log("LEAP: A Leap device has been disconnected.")}),this.controller.on("frame",this._handleFrame.bind(this)),this.controller.connect(),c&&(d.readyCallback=c),e&&(d.pausedCallback=e),f&&(d.gestureCallbacks=f)},d.getId=function(){return++d.idCount},d.add=function(b,c){var e,f,g,h,i=c||{};if(d._records.list,h=this.getAllItemsByName(b,d._pool),h.length){for(e=0,f=d._pool.length;f>e;e++)if(d._pool[e].name===b){g=d._pool.splice(e,1)[0];break}}else g=new a[b](i);return g.reset(i),g.init(i),d._records.list.push(g),g},d._handleFrame=function(b){var c,e,f,i,j,k;if(b.hands.length){var l=b.hands[0];for(j=d.getAllItemsByAttribute("handId",l.id)[0],j?j.step(b.id,l):(d.add("Palm",{frameId:b.id,handId:l.id}),d.toggle=!1),c=0,e=a.Utils.constrain(b.fingers.length,0,5);e>c;c++)k=d.getAllItemsByAttribute("fingerId",b.fingers[c].id)[0],k?k.step(b.id,b.fingers[c]):d.add("Finger",{frameId:b.id,handId:b.fingers[c].handId,fingerId:b.fingers[c].id});var m=d.getAllItemsByName("Palm"),n=d.getAllItemsByName("Finger");for(c=0,e=m.length;e>c;c++)for(f=0,i=n.length;i>f;f++)if(n[f].handId===m[c].handId){var o=d.getAllItemsByAttribute("connectorId",n[f].fingerId)[0];o?o.step(b.id):d.add("Connector",{frameId:b.id,fingerId:n[f].fingerId,connectorId:n[f].fingerId,parentA:n[f],parentB:m[c]})}var p=d.getAllItemsWithoutAttribute("frameId",b.id);for(c=0,e=p.length;e>c;c++)d.destroyItem(p[c]);for(c=d._records.list.length-1;c>=0;c--)d._records.list[c].draw()}else{if(d._records.list.length)for(c=d._records.list.length-1;c>=0;c--)d.destroyItem(d._records.list[c]);d.ready=!1,g.color=[0,0,0],h.color=[100,100,100]}if(b.hands[0]&&b.hands[0].palmNormal[1]>.5&&!d.toggle?d.toggle=!0:b.hands[0]&&b.hands[0].palmNormal[1]<-.5&&d.toggle&&(d.toggle=!1,d.ready=!d.ready,d.ready?(g.activeColor(),h.activeColor(),d.readyCallback()):(g.defaultColor(),h.defaultColor(),d.pausedCallback())),b.gestures.length&&d.ready){var q=b.gestures[0];d.gestureCallbacks[q.type]&&"update"===q.state&&d.gestureCallbacks[q.type].call(this,q)}},d.readyCallback=function(){console.log("Set System.readyCallback by passing a function as the second argument to System.init().")},d.pausedCallback=function(){console.log("Set System.pausedCallback by passing a function as the third argument to System.init().")},d.destroyItem=function(a){var b,c,e=this._records.list;for(b=0,c=e.length;c>b;b++)if(e[b].id===a.id){e[b].el.style.visibility="hidden",e[b].el.style.display="none",e[b].el.style.opacity=0,d._pool[d._pool.length]=e.splice(b,1)[0];break}},d.getAllItemsByName=function(a,b){var c,d,e=[],f=b||this._records.list;for(c=0,d=f.length;d>c;c++)f[c].name===a&&(e[e.length]=f[c]);return e},d.getAllItemsByAttribute=function(a,b){var c,d,e=[],f=this._records.list,g="undefined"!=typeof b?b:null;for(c=0,d=f.length;d>c;c++)if("undefined"!=typeof f[c][a]){if(null!==g&&f[c][a]!==g)continue;e[e.length]=f[c]}return e},d.getAllItemsWithoutAttribute=function(a,b){var c,d,e=[],f=this._records.list,g="undefined"!=typeof b?b:null;for(c=0,d=f.length;d>c;c++)("undefined"==typeof f[c][a]||f[c][a]!==g)&&(e[e.length]=f[c]);return e},d.updateItemPropsByName=function(a,b){var c,d,e,f=this.getAllItemsByName(a);for(c=0,d=f.length;d>c;c++)for(e in b)b.hasOwnProperty(e)&&(f[c][e]=b[e]);return f},a.Utils.extend(e,f),e.prototype.init=function(a){if(!a||!a.parentA||!a.parentB)throw new Error("Connector: both parentA and parentB are required.");this.parentA=a.parentA,this.parentB=a.parentB,this.frameId=a.frameId,this.connectorId=a.connectorId,this.width=0,this.height=0,this.borderWidth=1,this.borderRadius=0,this.borderStyle="dotted",this.borderColor="undefined"==typeof a.borderColor?[150,150,150]:a.borderColor,this.color="transparent",this.zIndex=a.zIndex||5,this.visibility="hidden",this.el.classList.add(this.name.toLowerCase())},e.prototype.step=function(b){var c=this.parentA.location,d=this.parentB.location;this.frameId=b,this.visibility="visible",this.width=Math.floor(a.Vector.VectorSub(this.parentA.location,this.parentB.location).mag()),this.location=a.Vector.VectorAdd(this.parentA.location,this.parentB.location).div(2),this.angle=i.radiansToDegrees(Math.atan2(d.y-c.y,d.x-c.x))},f.prototype.init=function(){throw new Error("init() not implemented in "+this.name+" class.")},f.prototype.reset=function(b){var c,d=b||{};for(c in d)d.hasOwnProperty(c)&&(this[c]=d[c]);this.frameId=d.frameId,this.handId=d.handId,this.fingerId=d.fingerId,this.connectorId=d.connectorId,this.width="undefined"==typeof d.width?100:d.width,this.height="undefined"==typeof d.height?100:d.height,this.location=d.location||new a.Vector,this.scale="undefined"==typeof d.scale?1:d.scale,this.angle=d.angle||0,this.color=d.color||h.color,this.borderRadius="undefined"==typeof d.borderRadius?100:d.borderRadius,this.borderWidth=d.borderWidth||0,this.borderStyle=d.borderStyle||"none",this.zIndex="undefined"==typeof d.zIndex?1:d.zIndex,this.visibility=d.visibility||"visible"},f.prototype.draw=function(){var b=this,c=a.Utils.getCSSText({x:b.location.x-b.width/2||-5e3,y:b.location.y-b.height/2||-5e3,angle:b.angle||0,scale:b.scale||1,width:b.width||0,height:b.height||0,color0:b.color[0],color1:b.color[1],color2:b.color[2],visibility:b.visibility,opacity:b.opacity,zIndex:b.zIndex,borderWidth:b.borderWidth,borderStyle:b.borderStyle,borderRadius:b.borderRadius});this.el.style.cssText=c},g.color=[0,0,0],a.Utils.extend(g,f),g.defaultColor=function(){a.System.updateItemPropsByName("Palm",{color:[0,0,0]}),g.color=[0,0,0]},g.activeColor=function(){a.System.updateItemPropsByName("Palm",{color:[200,50,0]}),g.color=[200,50,0]},g.prototype.init=function(){this.width=100,this.height=100,this.color=g.color,this.zIndex=10,this.visibility="hidden",this.el.classList.add(this.name.toLowerCase())},g.prototype.step=function(b,c){this.frameId=b,this.visibility="visible";var e=c.stabilizedPalmPosition,f=d.interactionBox.normalizePoint(e,!1);c.valid&&f[0]<1&&f[0]>0&&f[1]<1&&f[1]>0&&f[2]<1&&f[2]>0&&(this.location.x=a.Utils.map(f[0],0,1,0,d.viewportSize.width),this.location.y=a.Utils.map(f[1],0,1,d.viewportSize.height,0),this.scale=f[2],this.angle=-a.Utils.radiansToDegrees(c.roll())),this.palmNormal=c.palmNormal},h.color=[100,100,100],a.Utils.extend(h,f),h.defaultColor=function(){a.System.updateItemPropsByName("Finger",{color:[100,100,100]}),h.color=[100,100,100]},h.activeColor=function(){a.System.updateItemPropsByName("Finger",{color:[255,100,0]}),h.color=[255,100,0]},h.prototype.init=function(){this.width=50,this.height=50,this.color=h.color,this.zIndex=1,this.visibility="hidden",this.el.classList.add(this.name.toLowerCase())},h.prototype.step=function(b,c){this.frameId=b,this.visibility="visible";var e=c.stabilizedTipPosition,f=d.interactionBox.normalizePoint(e,!1);c.valid&&f[0]<1&&f[0]>0&&f[1]<1&&f[1]>0&&f[2]<1&&f[2]>0&&(this.location.x=a.Utils.map(f[0],0,1,0,d.viewportSize.width),this.location.y=a.Utils.map(f[1],0,1,d.viewportSize.height,0),this.scale=f[2],this.angle=0)},a.Utils=i,a.Vector=c,a.System=d,a.Connector=e,a.Item=f,a.Palm=g,a.Finger=h}({},function(){return this}());